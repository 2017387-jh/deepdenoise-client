<UserControl x:Class="DeepDenoiseClient.Views.Tabs.HttpTab"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2.5*"/>
            <ColumnDefinition Width="2.9*"/>
        </Grid.ColumnDefinitions>

        <!-- Left column: flow -->
        <StackPanel Margin="0,0,14,0">
            <TextBlock Text="API Base" Style="{StaticResource LabelText}"/>
            <TextBox Text="{Binding HttpVM.ApiBase, RelativeSource={RelativeSource AncestorType=Window}}"/>

            <StackPanel Orientation="Horizontal" Margin="0,6,0,0">
                <Button Content="Select Image" Command="{Binding HttpVM.PickFileCommand, RelativeSource={RelativeSource AncestorType=Window}}"/>
                <TextBlock Text="{Binding HttpVM.FilePath, RelativeSource={RelativeSource AncestorType=Window}}"
                   VerticalAlignment="Center" Foreground="{StaticResource BrushSubText}"/>
            </StackPanel>

            <TextBlock Text="S3 Object Key" Style="{StaticResource LabelText}"/>
            <TextBox Text="{Binding HttpVM.ObjectKey, RelativeSource={RelativeSource AncestorType=Window}}"/>

            <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                <Button Content="Get Upload URL" Command="{Binding HttpVM.GetUploadUrlCommand, RelativeSource={RelativeSource AncestorType=Window}}"/>
                <Button Content="Cancel" Command="{Binding HttpVM.GetUploadUrlCancelCommand, RelativeSource={RelativeSource AncestorType=Window}}"/>
            </StackPanel>
            <TextBox Height="44" TextWrapping="Wrap"
               Text="{Binding HttpVM.PresignedPutUrl, RelativeSource={RelativeSource AncestorType=Window}}"/>

            <StackPanel Orientation="Horizontal" Margin="0,6,0,0">
                <Button Content="Upload" Command="{Binding HttpVM.UploadCommand, RelativeSource={RelativeSource AncestorType=Window}}"/>
                <Button Content="Cancel" Command="{Binding HttpVM.UploadCancelCommand, RelativeSource={RelativeSource AncestorType=Window}}"/>
            </StackPanel>
            <ProgressBar Margin="0,6,0,0"
                   Minimum="0" Maximum="100"
                   Value="{Binding HttpVM.ProgressPercent, RelativeSource={RelativeSource AncestorType=Window}}"/>

            <Separator Margin="0,12,0,12"/>

            <TextBlock Text="Output Key (Option)" Style="{StaticResource LabelText}"/>
            <TextBox Text="{Binding HttpVM.OutputKey, RelativeSource={RelativeSource AncestorType=Window}}"/>

            <TextBlock Text="Correlation Id" Style="{StaticResource LabelText}"/>
            <TextBox Text="{Binding HttpVM.CorrelationId, RelativeSource={RelativeSource AncestorType=Window}}"/>

            <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                <Button Content="Output URL" Command="{Binding HttpVM.GetDownloadUrlCommand, RelativeSource={RelativeSource AncestorType=Window}}"/>
                <Button Content="Cancel" Command="{Binding HttpVM.GetDownloadUrlCancelCommand, RelativeSource={RelativeSource AncestorType=Window}}"/>
            </StackPanel>
            <TextBox Height="44" TextWrapping="Wrap"
               Text="{Binding HttpVM.PresignedGetUrl, RelativeSource={RelativeSource AncestorType=Window}}"/>

            <StackPanel Orientation="Horizontal" Margin="0,12,0,0">
                <Button Padding="10" 
                    HorizontalContentAlignment="Center"
                    VerticalContentAlignment="Center">
                    <TextBlock Text="Run all&#10;(Upload → Invoke → Download)" TextAlignment="Center" />
                </Button>

                <Button Padding="10"
                    HorizontalContentAlignment="Center"
                    VerticalContentAlignment="Center"
                    Content="Cancel" />
            </StackPanel>
        </StackPanel>

        <!-- Right column: request/response -->
        <Grid Grid.Column="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <!-- Request title -->
                <RowDefinition Height="Auto"/>
                <!-- Request card -->
                <RowDefinition Height="Auto"/>
                <!-- Invoke buttons -->
                <RowDefinition Height="Auto"/>
                <!-- Response title -->
                <RowDefinition Height="*"/>
                <!-- Response card (fills remaining space) -->
            </Grid.RowDefinitions>

            <!-- Request -->
            <TextBlock Grid.Row="0" Text="Request Body(JSON)" Style="{StaticResource SectionTitle}"/>

            <Border Grid.Row="1" Style="{StaticResource Card}">
                <TextBox AcceptsReturn="True" Height="200" VerticalScrollBarVisibility="Auto"
                    Text="{Binding HttpVM.RequestJson, RelativeSource={RelativeSource AncestorType=Window}}"/>
            </Border>

            <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,12,0,12">
                <Button Padding="10" 
                    Command="{Binding HttpVM.InvokeCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                    HorizontalContentAlignment="Center"
                    VerticalContentAlignment="Center">
                    <TextBlock Text="Send&#10;(/Invocations)" TextAlignment="Center" />
                </Button>
                <Button Content="Cancel" 
            Command="{Binding HttpVM.InvokeCancelCommand, RelativeSource={RelativeSource AncestorType=Window}}"/>
            </StackPanel>

            <!-- Response -->
            <TextBlock Grid.Row="3" Text="Response JSON" Style="{StaticResource SectionTitle}"/>

            <Border Grid.Row="4" Style="{StaticResource Card}">
                <TextBox AcceptsReturn="True"
                TextWrapping="NoWrap"
                VerticalAlignment="Stretch"
                VerticalScrollBarVisibility="Auto"
                HorizontalScrollBarVisibility="Auto"
                IsReadOnly="True"
                IsReadOnlyCaretVisible="False" 
                FontFamily="Consolas"
                BorderThickness="1"
                Text="{Binding HttpVM.ResponseJson, RelativeSource={RelativeSource AncestorType=Window}, Mode=OneWay}"/>
            </Border>
        </Grid>
    </Grid>
</UserControl>
